# Aircraft Detection with YOLO

This project provides a complete local workflow for airplane detection using YOLO, from dataset preparation and enhancement to training, evaluation, and multiple inference modes.

The workflow supports:

- Raw and enhanced datasets
- Dataset splitting into train, val, test
- YOLO training and evaluation
- Inference on image folders, videos, USB cameras, and shared screen
- Interactive launcher using `app.py`

---

## Project Structure

```
AIRPLANE-DETECTION/
│
├─ dataset/
│  ├─ raw/
│  │  ├─ images/
│  │  └─ labels/
│  ├─ enhanced/
│  │  ├─ images/
│  │  └─ labels/
│  ├─ splits/
│  │  ├─ raw/
│  │  │  ├─ train/
│  │  │  ├─ val/
│  │  │  └─ test/
│  │  └─ enhanced/
│  │     ├─ train/
│  │     ├─ val/
│  │     └─ test/
│  ├─ classes.txt
│  ├─ data_raw.yaml
│  └─ data_enhanced.yaml
│
├─ inference/
│  ├─ input_detect_images/
│  ├─ output_detect_images/
│  ├─ yolo_detect_input_image.py
│  ├─ yolo_detect_share_screen.py
│  └─ yolo_detect.py
│
├─ models/
│  ├─ raw_2026_01_11_001_best.pt
│  └─ enhanced_2026_01_11_001_best.pt
│
├─ scripts/
│  ├─ split_dataset.py
│  ├─ enhance_dataset.py
│  ├─ sharpen_all_images_unsharp.py
│  ├─ create_data_yaml.py
│  ├─ train.py
│  └─ evaluate.py
│
├─ runs/                 # auto generated by YOLO
├─ yolo11n.pt
├─ yolo11s.pt
├─ requirements.txt
├─ app.py                # detection method launcher
├─ main.py
└─ README.md
```

---

## Environment Setup

### Create Conda Environment

```
conda create -n yolo-env python=3.12
conda activate yolo-env
```

### Install Dependencies

```
pip install -r requirements.txt
```

### Verify GPU

```
python -c "import torch; print(torch.cuda.is_available())"
```

---

## Dataset Preparation

### 1. Label Images with Label Studio

Start Label Studio:

```
label-studio start
```

Open in browser:

```
http://localhost:8080
```

Export labels in YOLO format.

Copy files:

- Images → `dataset/raw/images/`
- Labels → `dataset/raw/labels/`

---

### 2. Enhance Dataset (Optional)

Apply enhancement or sharpening:

```
python scripts/enhance_dataset.py
```

or

```
python scripts/sharpen_all_images_unsharp.py
```

Enhanced images and labels will be saved to:

```
dataset/enhanced/images
dataset/enhanced/labels
```

---

### 3. Split Dataset

Split raw dataset:

```
python scripts/split_dataset.py --dataset raw
```

Split enhanced dataset:

```
python scripts/split_dataset.py --dataset enhanced
```

Output:

```
dataset/splits/raw/train val test
dataset/splits/enhanced/train val test
```

---

### 4. Generate data.yaml

For raw dataset:

```
python scripts/create_data_yaml.py --dataset raw
```

For enhanced dataset:

```
python scripts/create_data_yaml.py --dataset enhanced
```

This creates:

- `dataset/data_raw.yaml`
- `dataset/data_enhanced.yaml`

---

## Training

Train using raw dataset:

```
yolo detect train model=yolo11s.pt data=dataset/data_raw.yaml epochs=60 imgsz=640
```

Train using enhanced dataset:

```
yolo detect train model=yolo11s.pt data=dataset/data_enhanced.yaml epochs=60 imgsz=640
```

Best model saved to:

```
runs/detect/train/weights/best.pt
```

Copy to models folder:

```
cp runs/detect/train/weights/best.pt models/raw_YYYY_MM_DD_best.pt
```

---

## Evaluation

Evaluate raw model:

```
python scripts/evaluate.py --dataset raw --model models/raw_2026_01_11_001_best.pt
```

Evaluate enhanced model:

```
python scripts/evaluate.py --dataset enhanced --model models/enhanced_2026_01_11_001_best.pt
```

Metrics reported:

- Precision
- Recall
- mAP50
- mAP50-95
- Inference speed

---

## Inference

### Recommended Method

Use launcher:

```
python app.py
```

Menu allows you to choose:

1. Image folder detection
2. Video or USB camera
3. Share screen detection

App checks:

- image folder exists
- images exist before running

---

### Image Folder Detection

Copy test images into:

```
inference/input_detect_images/
```

Run:

```
python inference/yolo_detect_input_image.py
```

Results saved to:

```
inference/output_detect_images/
```

---

### Webcam or USB Camera

Example:

```
python inference/yolo_detect.py --source usb0 --resolution 1280x720
```

Select model:

```
python inference/yolo_detect.py --model models/raw_2026_01_11_001_best.pt --source usb0
```

---

### Video File

```
python inference/yolo_detect.py --source test.mp4
```

---

### Share Screen Detection

```
python inference/yolo_detect_share_screen.py
```

---

## Notes

- On Windows, use numeric camera index, example: `usb0`, `usb1`
- Inference FPS is lower than pure model FPS due to OpenCV display
- Enhanced dataset did not improve box accuracy in current experiment

---

## License

For academic and research use only.

---
